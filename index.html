<!DOCTYPE html>
<html>
<head>
  <title>FLUX Pro Max - Replicate</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;padding:20px}
    .container{max-width:900px;margin:0 auto;background:white;border-radius:15px;padding:30px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
    h1{text-align:center;color:#333;margin-bottom:20px;font-size:2.2rem}
    textarea{width:100%;padding:15px;border:2px solid #ddd;border-radius:8px;font-size:16px;resize:vertical;min-height:80px}
    textarea:focus{outline:none;border-color:#667eea}
    button{padding:16px;background:#667eea;color:white;border:none;border-radius:8px;font-size:16px;cursor:pointer;width:100%;margin-top:10px}
    button:disabled{opacity:0.6;cursor:not-allowed}
    .loading{color:#667eea;padding:20px;text-align:center}
    .error{color:#e74c3c;background:#fdf0f0;padding:15px;border-radius:8px;border-left:4px solid #e74c3c}
    .chip{background:#e9ecef;padding:6px 14px;border-radius:20px;font-size:0.9em;cursor:pointer;margin:5px;display:inline-block}
    .gallery{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:10px;margin-top:20px}
    .gallery img{width:100%;border-radius:8px;cursor:pointer}
  </style>
</head>
<body>
<div class="container">
  <h1>FLUX Pro Max</h1>
  <p style="text-align:center;color:#666;margin-bottom:20px">Replicate: <strong>100 gambar GRATIS/hari</strong> + Upload gambar!</p>

  <div style="margin-bottom:15px">
    <label><strong>Positive Prompt</strong></label>
    <textarea id="positive" placeholder="cyberpunk cat with neon glasses..."></textarea>
  </div>

  <div style="margin-bottom:15px">
    <label><strong>Negative Prompt</strong></label>
    <textarea id="negative" placeholder="blurry, ugly, deformed"></textarea>
  </div>

  <div style="margin-bottom:15px">
    <label><strong>Reference Image (opsional)</strong></label>
    <input type="file" id="image" accept="image/*" style="width:100%;padding:10px">
  </div>

  <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:15px">
    <div class="chip" onclick="set('cyberpunk cat with neon glasses','blurry, ugly')">Cyber Cat</div>
    <div class="chip" onclick="set('snow cat','')">Snow Cat</div>
    <div class="chip" onclick="set('anime girl cat ears','realistic')">Anime Cat</div>
  </div>

  <button id="btn" onclick="generate()">Generate with Replicate (15-30 Detik)</button>
  <div id="result"></div>
</div>

<script>
  const WORKER_URL = 'https://flux-pro-max.ipanutomo.workers.dev';

  function set(pos, neg) {
    document.getElementById('positive').value = pos;
    document.getElementById('negative').value = neg;
  }

  async function generate() {
    const pos = document.getElementById('positive').value.trim();
    const neg = document.getElementById('negative').value.trim();
    const file = document.getElementById('image').files[0];
    const btn = document.getElementById('btn');
    const result = document.getElementById('result');

    if (!pos) return alert('Prompt wajib!');

    btn.disabled = true;
    btn.textContent = 'Replicate lagi generate... (15-30 detik)';
    result.innerHTML = '<div class="loading">Sedang proses, sabar ya...</div>';

    const form = new FormData();
    form.append('prompt', pos);
    if (neg) form.append('negative', neg);
    if (file) form.append('image', file);

    try {
      const res = await fetch(WORKER_URL, { method: 'POST', body: form });
      if (!res.ok) {
        const err = await res.json();
        throw new Error(err.error || 'Server error');
      }
      const blob = await res.blob();
      const url = URL.createObjectURL(blob);
      result.innerHTML = `
        <img src="${url}" style="max-width:100%;border-radius:12px;margin:15px 0">
        <a href="${url}" download="replicate-${Date.now()}.png" style="background:#10b981;color:white;padding:10px 20px;border-radius:8px;text-decoration:none">
          Download 1024Ã—1024
        </a>
      `;
    } catch (e) {
      result.innerHTML = `<div class="error">Error: ${e.message}</div>`;
    } finally {
      btn.disabled = false;
      btn.textContent = 'Generate with Replicate (15-30 Detik)';
    }
  }
</script>
</body>
</html>
